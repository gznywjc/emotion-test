<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>æƒ…ç»ªå†…è€—æµ‹è¯•</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;600;700&family=Noto+Sans+SC:wght@300;400;500&display=swap');
:root{--bg:#FDF8F4;--white:#FFFFFF;--td:#3A3330;--tm:#7A6E6A;--tl:#B0A49E;--bd:#EDE4DC;--pk:#E8A0A0;--lv:#C4B8D8;--sg:#A8C4B0;--sh:rgba(180,150,130,0.12)}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:'Noto Sans SC',sans-serif;background:var(--bg);min-height:100vh;color:var(--td);overflow-x:hidden}
body::before{content:'';position:fixed;top:-200px;right:-200px;width:500px;height:500px;background:radial-gradient(circle,rgba(232,160,160,.12) 0%,transparent 70%);pointer-events:none;z-index:0}
body::after{content:'';position:fixed;bottom:-200px;left:-200px;width:500px;height:500px;background:radial-gradient(circle,rgba(168,196,176,.12) 0%,transparent 70%);pointer-events:none;z-index:0}
.wrap{max-width:460px;margin:0 auto;padding:0 22px 80px;position:relative;z-index:1}

/* ===== æ¿€æ´»ç é¡µ ===== */
#pg-activate{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:50px 0 40px}
.lock-icon{width:90px;height:90px;background:linear-gradient(135deg,#F2C4A8,#E8A0A0);border-radius:28px;display:flex;align-items:center;justify-content:center;font-size:40px;margin:0 auto 28px;box-shadow:0 12px 32px rgba(232,160,160,.3);animation:pulse 4s ease-in-out infinite}
@keyframes pulse{0%,100%{box-shadow:0 12px 32px rgba(232,160,160,.3)}50%{box-shadow:0 16px 40px rgba(232,160,160,.45)}}
.act-title{font-family:'Noto Serif SC',serif;font-size:26px;font-weight:700;color:var(--td);margin-bottom:10px}
.act-sub{font-size:13px;color:var(--tm);line-height:1.8;margin-bottom:36px}
.act-card{background:var(--white);border-radius:24px;padding:28px;width:100%;box-shadow:0 4px 24px var(--sh);border:1px solid var(--bd);margin-bottom:16px}
.act-label{font-size:12px;color:var(--tl);letter-spacing:2px;margin-bottom:12px;text-align:left}
.act-input-wrap{position:relative;margin-bottom:16px}
.act-input{width:100%;padding:16px 50px 16px 18px;border:1.5px solid var(--bd);border-radius:16px;font-size:15px;font-family:'Noto Sans SC',sans-serif;color:var(--td);background:var(--bg);outline:none;letter-spacing:3px;transition:border-color .25s ease;text-transform:uppercase}
.act-input:focus{border-color:var(--pk)}
.act-input::placeholder{letter-spacing:1px;font-size:13px;color:var(--tl)}
.act-eye{position:absolute;right:16px;top:50%;transform:translateY(-50%);cursor:pointer;font-size:18px;color:var(--tl);user-select:none}
.act-error{font-size:12px;color:#D4756A;text-align:left;margin-bottom:12px;min-height:18px;transition:opacity .25s ease}
.btn-activate{width:100%;padding:17px;background:linear-gradient(135deg,#E8A0A0,#C4B8D8);color:white;border:none;border-radius:50px;font-size:15px;font-family:'Noto Sans SC',sans-serif;font-weight:500;letter-spacing:2px;cursor:pointer;box-shadow:0 8px 28px rgba(232,160,160,.4);transition:all .3s ease}
.btn-activate:hover{transform:translateY(-2px);box-shadow:0 12px 36px rgba(232,160,160,.5)}
.act-hint{font-size:11px;color:var(--tl);line-height:1.8}
.act-hint a{color:var(--pk);text-decoration:none}

/* ===== å°é¢ ===== */
#pg-cover{display:none;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:50px 0 40px;min-height:100vh}
.flower-wrap{position:relative;width:180px;height:180px;margin:0 auto 36px}
.fr{position:absolute;border-radius:50%;border:1px solid}
.fr1{inset:0;border-color:rgba(232,160,160,.3);animation:spin1 8s ease-in-out infinite}
.fr2{inset:22px;border-color:rgba(196,184,216,.4);animation:spin1 6s ease-in-out infinite reverse}
.fr3{inset:44px;border-color:rgba(168,196,176,.5)}
@keyframes spin1{0%,100%{transform:scale(1) rotate(0deg)}50%{transform:scale(1.04) rotate(3deg)}}
.fc{position:absolute;inset:62px;background:linear-gradient(135deg,#F2C4A8,#E8A0A0);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:28px;box-shadow:0 8px 24px rgba(232,160,160,.3);animation:pulse 4s ease-in-out infinite}
.dot{position:absolute;border-radius:50%;animation:fdot 5s ease-in-out infinite}
.d1{width:8px;height:8px;background:rgba(232,160,160,.4);top:10px;left:20px;animation-delay:0s}
.d2{width:6px;height:6px;background:rgba(196,184,216,.5);top:30px;right:10px;animation-delay:1s}
.d3{width:10px;height:10px;background:rgba(168,196,176,.4);bottom:20px;left:10px;animation-delay:2s}
.d4{width:5px;height:5px;background:rgba(240,217,168,.6);bottom:15px;right:25px;animation-delay:.5s}
@keyframes fdot{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
.chip{display:inline-flex;align-items:center;gap:6px;background:var(--white);border:1px solid var(--bd);border-radius:20px;padding:6px 16px;font-size:12px;color:var(--tm);margin-bottom:20px;box-shadow:0 2px 12px var(--sh)}
.chip-dot{width:6px;height:6px;border-radius:50%;background:var(--sg);animation:blink 2s ease-in-out infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}
.cover-title{font-family:'Noto Serif SC',serif;font-size:30px;font-weight:700;line-height:1.4;color:var(--td);margin-bottom:14px}
.cover-title em{font-style:normal;background:linear-gradient(135deg,#E8A0A0,#C4B8D8);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.cover-sub{font-size:14px;color:var(--tm);line-height:1.9;margin-bottom:36px}
.stats{display:flex;background:var(--white);border-radius:18px;padding:20px;margin-bottom:32px;box-shadow:0 4px 20px var(--sh);border:1px solid var(--bd);width:100%}
.si{flex:1;text-align:center}
.si+.si{border-left:1px solid var(--bd)}
.sn{font-family:'Noto Serif SC',serif;font-size:26px;font-weight:700;color:var(--td)}
.sl{font-size:11px;color:var(--tl);margin-top:3px}
.btn-start{width:100%;max-width:280px;padding:17px 24px;background:linear-gradient(135deg,#E8A0A0,#C4B8D8);color:white;border:none;border-radius:50px;font-size:16px;font-family:'Noto Sans SC',sans-serif;font-weight:500;letter-spacing:2px;cursor:pointer;box-shadow:0 8px 28px rgba(232,160,160,.4);transition:all .3s ease}
.btn-start:hover{transform:translateY(-3px);box-shadow:0 12px 36px rgba(232,160,160,.5)}
.cover-tip{margin-top:14px;font-size:11px;color:var(--tl)}

/* ===== æµ‹è¯•é¡µ ===== */
#pg-quiz{display:none;padding-top:36px}
.qtop{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
.qstep{font-size:12px;color:var(--tl);letter-spacing:1px}
.qfrac{font-family:'Noto Serif SC',serif;font-size:13px;color:var(--tm);font-weight:600}
.prog-track{width:100%;height:4px;background:var(--bd);border-radius:4px;margin-bottom:40px;overflow:hidden}
.prog-fill{height:100%;background:linear-gradient(90deg,#E8A0A0,#C4B8D8);border-radius:4px;transition:width .6s cubic-bezier(.4,0,.2,1);width:0%}
.q-card{background:var(--white);border-radius:24px;padding:32px 24px;margin-bottom:20px;box-shadow:0 4px 24px var(--sh);border:1px solid var(--bd)}
.q-badge{display:inline-flex;align-items:center;gap:6px;background:linear-gradient(135deg,rgba(232,160,160,.15),rgba(196,184,216,.15));border-radius:20px;padding:4px 12px;font-size:11px;color:var(--pk);letter-spacing:1px;margin-bottom:16px;border:1px solid rgba(232,160,160,.2)}
.q-text{font-family:'Noto Serif SC',serif;font-size:20px;font-weight:600;line-height:1.6;color:var(--td);margin-bottom:6px}
.q-hint{font-size:12px;color:var(--tl);line-height:1.6}
.opts{display:flex;flex-direction:column;gap:10px}
.opt{display:flex;align-items:center;gap:14px;padding:16px 18px;background:var(--bg);border:1.5px solid var(--bd);border-radius:16px;cursor:pointer;transition:all .25s ease;text-align:left;width:100%;font-family:'Noto Sans SC',sans-serif}
.opt:hover{border-color:var(--pk);background:rgba(232,160,160,.06);transform:translateX(3px)}
.opt.chosen{border-color:var(--pk);background:linear-gradient(135deg,rgba(232,160,160,.1),rgba(196,184,216,.08))}
.oc{width:22px;height:22px;border-radius:50%;border:1.5px solid var(--bd);flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:all .25s ease;font-size:11px;color:transparent}
.opt.chosen .oc{border-color:var(--pk);background:linear-gradient(135deg,#E8A0A0,#C4B8D8);color:white}
.ot{font-size:14px;color:var(--td);line-height:1.5;font-weight:400}
.opt.chosen .ot{font-weight:500}
.btn-next{width:100%;padding:17px;background:linear-gradient(135deg,#E8A0A0,#C4B8D8);color:white;border:none;border-radius:50px;font-size:15px;font-family:'Noto Sans SC',sans-serif;font-weight:500;letter-spacing:1px;cursor:pointer;opacity:0;transform:translateY(12px);transition:all .4s cubic-bezier(.4,0,.2,1);pointer-events:none;box-shadow:0 6px 24px rgba(232,160,160,.35);margin-top:20px}
.btn-next.show{opacity:1;transform:translateY(0);pointer-events:all}
.btn-next:hover{transform:translateY(-2px);box-shadow:0 10px 30px rgba(232,160,160,.45)}

/* ===== ç»“æœé¡µ ===== */
#pg-result{display:none;padding-top:36px}
.rhl{text-align:center;font-size:11px;letter-spacing:3px;color:var(--tl);margin-bottom:24px}
.rc{background:var(--white);border-radius:28px;overflow:hidden;margin-bottom:20px;box-shadow:0 8px 40px var(--sh);border:1px solid var(--bd)}
.rch{padding:32px 28px 24px;position:relative;overflow:hidden}
.rch::before{content:'';position:absolute;inset:0;opacity:.12}
.lv1 .rch::before{background:linear-gradient(135deg,#A8C4B0,#C4D8C0)}
.lv2 .rch::before{background:linear-gradient(135deg,#C4B8D8,#D8D0EC)}
.lv3 .rch::before{background:linear-gradient(135deg,#F2C4A8,#F0D9A8)}
.lv4 .rch::before{background:linear-gradient(135deg,#E8A0A0,#F2C4A8)}
.rtr{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:20px}
.rscore{font-family:'Noto Serif SC',serif;font-size:72px;font-weight:700;line-height:1;color:var(--td)}
.rsub{font-size:12px;color:var(--tl);margin-top:4px}
.rbadge{display:inline-block;padding:6px 14px;border-radius:20px;font-size:12px;font-weight:500;letter-spacing:1px;margin-bottom:6px}
.lv1 .rbadge{background:rgba(168,196,176,.2);color:#6A9E78;border:1px solid rgba(168,196,176,.4)}
.lv2 .rbadge{background:rgba(196,184,216,.2);color:#8878B4;border:1px solid rgba(196,184,216,.4)}
.lv3 .rbadge{background:rgba(242,196,168,.2);color:#C47840;border:1px solid rgba(242,196,168,.4)}
.lv4 .rbadge{background:rgba(232,160,160,.2);color:#D4756A;border:1px solid rgba(232,160,160,.4)}
.rmn{font-size:11px;color:var(--tl)}
.remoji{font-size:36px;margin-bottom:10px;display:block}
.rtitle{font-family:'Noto Serif SC',serif;font-size:24px;font-weight:700;color:var(--td);line-height:1.3;margin-bottom:8px}
.rtag{font-size:13px;color:var(--tm);line-height:1.7}
.rcb{padding:24px 28px}
.rsec{margin-bottom:24px}
.rsec:last-child{margin-bottom:0}
.rsl{display:flex;align-items:center;gap:8px;font-size:11px;letter-spacing:2px;color:var(--tl);margin-bottom:12px}
.rsl::after{content:'';flex:1;height:1px;background:var(--bd)}
.rdesc{font-size:14px;line-height:1.95;color:var(--tm)}
.rtraits{display:flex;flex-wrap:wrap;gap:8px}
.rtrait{padding:5px 14px;border-radius:20px;font-size:12px;color:var(--tm);background:var(--bg);border:1px solid var(--bd)}
.ac{background:var(--white);border-radius:24px;padding:28px;margin-bottom:20px;box-shadow:0 4px 24px var(--sh);border:1px solid var(--bd)}
.act2{font-family:'Noto Serif SC',serif;font-size:17px;font-weight:600;color:var(--td);margin-bottom:18px;display:flex;align-items:center;gap:8px}
.ais{display:flex;flex-direction:column;gap:14px}
.ai{display:flex;gap:12px;align-items:flex-start}
.aico{width:32px;height:32px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:15px;flex-shrink:0}
.lv1 .aico{background:rgba(168,196,176,.2)}
.lv2 .aico{background:rgba(196,184,216,.2)}
.lv3 .aico{background:rgba(242,196,168,.2)}
.lv4 .aico{background:rgba(232,160,160,.15)}
.ait{font-size:13px;line-height:1.8;color:var(--tm);padding-top:5px}
.sc{background:linear-gradient(135deg,rgba(232,160,160,.08),rgba(196,184,216,.08));border-radius:24px;padding:28px;border:1px solid var(--bd);text-align:center;margin-bottom:20px}
.st{font-family:'Noto Serif SC',serif;font-size:16px;font-weight:600;color:var(--td);margin-bottom:6px}
.ss{font-size:12px;color:var(--tl);margin-bottom:20px}
.btn-share{width:100%;padding:16px;background:linear-gradient(135deg,#E8A0A0,#C4B8D8);color:white;border:none;border-radius:50px;font-size:14px;font-family:'Noto Sans SC',sans-serif;font-weight:500;letter-spacing:1px;cursor:pointer;margin-bottom:10px;box-shadow:0 6px 20px rgba(232,160,160,.35);transition:all .3s ease}
.btn-share:hover{transform:translateY(-2px);box-shadow:0 10px 28px rgba(232,160,160,.45)}
.btn-retry{width:100%;padding:14px;background:transparent;color:var(--tl);border:1.5px solid var(--bd);border-radius:50px;font-size:13px;font-family:'Noto Sans SC',sans-serif;cursor:pointer;transition:all .3s ease}
.btn-retry:hover{border-color:var(--tm);color:var(--tm)}
.wm{text-align:center;font-size:11px;color:var(--bd);margin-top:28px}
.fade-in{animation:fi .5s ease forwards}
@keyframes fi{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}
.slide-in{animation:si .4s cubic-bezier(.4,0,.2,1) forwards}
@keyframes si{from{opacity:0;transform:translateX(28px)}to{opacity:1;transform:translateX(0)}}
</style>
</head>
<body>
<div class="wrap">

<!-- æ¿€æ´»ç é¡µ -->
<div id="pg-activate">
  <div class="lock-icon">ğŸ”‘</div>
  <h1 class="act-title">è¾“å…¥æ¿€æ´»ç </h1>
  <p class="act-sub">è´­ä¹°åç§ä¿¡è·å–ä¸“å±æ¿€æ´»ç <br>æ¯ä¸ªæ¿€æ´»ç ä»…é™ä½¿ç”¨ä¸€æ¬¡</p>
  <div class="act-card">
    <div class="act-label">æ¿€æ´»ç </div>
    <div class="act-input-wrap">
      <input class="act-input" id="code-input" type="password" placeholder="è¯·è¾“å…¥æ¿€æ´»ç " maxlength="12" autocomplete="off" autocorrect="off" spellcheck="false">
      <span class="act-eye" id="eye-btn">ğŸ‘</span>
    </div>
    <div class="act-error" id="act-error"></div>
    <button class="btn-activate" id="btn-activate">è§£é”æµ‹è¯• â†’</button>
  </div>
  <p class="act-hint">è¿˜æ²¡æœ‰æ¿€æ´»ç ï¼Ÿ<a href="#">ç‚¹å‡»è´­ä¹° 9.9å…ƒ</a><br>è´­ä¹°åç§ä¿¡å›å¤ã€Œæ¿€æ´»ç ã€å³å¯è·å–</p>
</div>

<!-- å°é¢ -->
<div id="pg-cover">
  <div class="flower-wrap">
    <div class="fr fr1"></div><div class="fr fr2"></div><div class="fr fr3"></div>
    <div class="fc">ğŸŒ¸</div>
    <div class="dot d1"></div><div class="dot d2"></div><div class="dot d3"></div><div class="dot d4"></div>
  </div>
  <div class="chip"><div class="chip-dot"></div>å¿ƒç†æµ‹è¯• Â· æƒ…ç»ªå¥åº·</div>
  <h1 class="cover-title">ä½ æ¯å¤©æœ‰å¤šå°‘èƒ½é‡<br>è¢«<em>æ‚„æ‚„æ¶ˆè€—</em>æ‰ï¼Ÿ</h1>
  <p class="cover-sub">é‚£äº›æ²¡è¯´å‡ºå£çš„è¯<br>åå¤å›æƒ³çš„åœºæ™¯ï¼Œæ·±å¤œçš„è‡ªæˆ‘è´¨ç–‘<br>éƒ½åœ¨æ…¢æ…¢åƒæ‰ä½ çš„èƒ½é‡ ğŸƒ</p>
  <div class="stats">
    <div class="si"><div class="sn">15</div><div class="sl">é“é¢˜ç›®</div></div>
    <div class="si"><div class="sn">3</div><div class="sl">åˆ†é’Ÿå®Œæˆ</div></div>
    <div class="si"><div class="sn">4</div><div class="sl">ç§ç»“æœ</div></div>
  </div>
  <button class="btn-start" id="btn-start">âœ¨ å¼€å§‹æµ‹è¯•</button>
  <p class="cover-tip">è¯·å‡­ç¬¬ä¸€ç›´è§‰ä½œç­”ï¼Œç»“æœæ›´å‡†ç¡®</p>
</div>

<!-- æµ‹è¯•é¡µ -->
<div id="pg-quiz">
  <div class="qtop">
    <span class="qstep">QUESTION</span>
    <span class="qfrac" id="q-frac">1 / 15</span>
  </div>
  <div class="prog-track"><div class="prog-fill" id="prog-fill"></div></div>
  <div id="q-wrap">
    <div class="q-card">
      <div class="q-badge">âœ¦ <span id="q-num-text">é¢˜ç›® 01</span></div>
      <div class="q-text" id="q-text"></div>
      <div class="q-hint" id="q-hint"></div>
    </div>
    <div class="opts" id="opts-wrap"></div>
    <button class="btn-next" id="btn-next">ç»§ç»­ â†’</button>
  </div>
</div>

<!-- ç»“æœé¡µ -->
<div id="pg-result">
  <div class="rhl">âœ¦ TEST RESULT âœ¦</div>
  <div class="rc fade-in" id="res-card">
    <div class="rch">
      <div class="rtr">
        <div><div class="rscore" id="res-score">0</div><div class="rsub" id="res-raw"></div></div>
        <div style="text-align:right"><div class="rbadge" id="res-badge"></div><div class="rmn">æ»¡åˆ† 100 åˆ†</div></div>
      </div>
      <span class="remoji" id="res-emoji"></span>
      <div class="rtitle" id="res-title"></div>
      <div class="rtag" id="res-tagline"></div>
    </div>
    <div class="rcb">
      <div class="rsec"><div class="rsl">ä½ çš„çŠ¶æ€æè¿°</div><div class="rdesc" id="res-desc"></div></div>
      <div class="rsec"><div class="rsl">ä½ çš„å†…è€—ç‰¹å¾</div><div class="rtraits" id="res-traits"></div></div>
    </div>
  </div>
  <div class="ac fade-in" id="advice-card">
    <div class="act2">ğŸŒ¿ <span id="advice-title"></span></div>
    <div class="ais" id="advice-items"></div>
  </div>
  <div class="sc">
    <div class="st">æµ‹å‡ºä½ çš„ç»“æœäº†å—ï¼ŸğŸŒ¸</div>
    <div class="ss">æˆªå›¾å‘å°çº¢ä¹¦ï¼Œè®©å¥½å‹ä¹Ÿæ¥æµ‹æµ‹</div>
    <button class="btn-share" id="btn-share">ğŸ“‹ ä¸€é”®å¤åˆ¶å°çº¢ä¹¦æ–‡æ¡ˆ</button>
    <button class="btn-retry" id="btn-retry">â†º é‡æ–°æµ‹è¯•</button>
  </div>
  <div class="wm">æƒ…ç»ªå†…è€—æµ‹è¯• Â· ä»…ä¾›å‚è€ƒ Â· è¯·å–„å¾…è‡ªå·±</div>
</div>
</div>

<script>
(function() {

  // ============================================================
  // æ¿€æ´»ç é…ç½®åŒºï¼ˆä½ è‡ªå·±æ”¹è¿™é‡Œï¼‰
  // æ ¼å¼ï¼š'æ¿€æ´»ç ': true  åŠ ä¸€è¡Œå°±æ˜¯å¤šä¸€ä¸ªç 
  // ç”¨å®Œçš„ç æ”¹æˆ falseï¼Œå°±æ— æ³•å†ä½¿ç”¨
  // ============================================================
  var CODES = {
    'XIAO001': true,
    'XIAO002': true,
    'XIAO003': true,
    'XIAO004': true,
    'XIAO005': true,
    'LUNA2024': true,
    'BLOOM888': true,
    'ROSE999': true
  };

  // å·²ä½¿ç”¨çš„ç ï¼ˆå­˜åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œé˜²æ­¢åŒä¸€è®¾å¤‡é‡å¤ç”¨ï¼‰
  // æ³¨æ„ï¼šæ¢è®¾å¤‡å¯ä»¥é‡å¤ç”¨ï¼Œè¿™æ˜¯çº¯å‰ç«¯æ–¹æ¡ˆçš„å±€é™
  var USED_KEY = 'emot_used_codes';

  function getUsed() {
    try { return JSON.parse(localStorage.getItem(USED_KEY) || '{}'); } catch(e){ return {}; }
  }
  function markUsed(code) {
    try { var u=getUsed(); u[code]=1; localStorage.setItem(USED_KEY, JSON.stringify(u)); } catch(e){}
  }

  function validateCode(raw) {
    var code = raw.trim().toUpperCase();
    if (!code) return 'è¯·è¾“å…¥æ¿€æ´»ç ';
    if (!(code in CODES)) return 'æ¿€æ´»ç æ— æ•ˆï¼Œè¯·æ£€æŸ¥åé‡è¯•';
    if (!CODES[code]) return 'è¯¥æ¿€æ´»ç å·²åœç”¨';
    var used = getUsed();
    if (used[code]) return 'è¯¥æ¿€æ´»ç åœ¨æ­¤è®¾å¤‡å·²ä½¿ç”¨è¿‡';
    return null; // null = éªŒè¯é€šè¿‡
  }

  // ============================================================

  var Q = [
    {t:'å‘å®Œä¸€æ¡æ¶ˆæ¯ï¼Œå¯¹æ–¹ä¸€ç›´æ²¡å›ï¼Œä½ ä¼šâ€¦â€¦', h:'é€‰æœ€æ¥è¿‘ä½ çœŸå®çŠ¶æ€çš„ä¸€é¡¹',
     o:['æ­£å¸¸ç­‰ï¼Œä¸åœ¨æ„æ—¶é—´','å¶å°”åˆ·æ–°ï¼Œä½†ä¸ä¼šç„¦è™‘','æ—¶ä¸æ—¶å»çœ‹ï¼Œæœ‰ç‚¹æ‹…å¿ƒ','åå¤åˆ·ï¼Œå¼€å§‹è„‘è¡¥å¯¹æ–¹ä¸ºä»€ä¹ˆä¸å›']},
    {t:'ä¸€ä»¶å°´å°¬çš„äº‹è¿‡å»ä¸€å‘¨äº†ï¼Œä½ è¿˜ä¼šæƒ³èµ·å®ƒå—ï¼Ÿ', h:'æ¯”å¦‚è¯´é”™è¯ã€åšé”™å†³å®š',
     o:['åŸºæœ¬å¿˜äº†ï¼Œæ´»åœ¨å½“ä¸‹','å¶å°”æƒ³èµ·ï¼Œä¸€é—ªè€Œè¿‡','è¿˜æ˜¯ä¼šæƒ³ï¼Œæœ‰ç‚¹ä»‹æ„','åå¤å›æ”¾ï¼Œè¶Šæƒ³è¶Šåæ‚”']},
    {t:'åˆ«äººéšå£ä¸€å¥è¯ï¼Œä½ ä¼šæ€ä¹ˆç†è§£ï¼Ÿ', h:'æ¯”å¦‚å¯¹æ–¹è¯´ï¼šä½ ä»Šå¤©æ°”è‰²ä¸å¤ªå¥½',
     o:['å­—é¢æ„æ€ï¼Œä»–å°±æ˜¯è¿™ä¹ˆè¯´','å¯èƒ½ç¨å¾®æƒ³æƒ³ï¼Œç„¶åæ”¾ä¸‹','ä¼šçŒœæœ‰æ²¡æœ‰åˆ«çš„æ„æ€','å¼€å§‹æ€€ç–‘è‡ªå·±ï¼Œåå¤æ£æ‘©']},
    {t:'ç¡å‰ï¼Œä½ çš„è„‘å­é€šå¸¸åœ¨åšä»€ä¹ˆï¼Ÿ', h:'è¯šå®ä½œç­”ï¼Œè¿™é¢˜å¾ˆå…³é”®',
     o:['æ”¾ç©ºï¼Œå¾ˆå¿«ç¡ç€','æƒ³äº›è½»æ¾çš„äº‹ï¼Œæ…¢æ…¢å…¥ç¡','å›æƒ³ä»Šå¤©ï¼Œæœ‰äº›äº‹æ²¡ç¿»ç¯‡','åœä¸ä¸‹æ¥ï¼Œå„ç§äº‹æƒ…æ¶Œæ¥']},
    {t:'åšå®Œå†³å®šåï¼Œä½ é€šå¸¸ä¼šâ€¦â€¦', h:'å¤§åˆ°æ¢å·¥ä½œï¼Œå°åˆ°é€‰èœéƒ½ç®—',
     o:['åšäº†å°±åšäº†ï¼Œä¸åæ‚”','å¶å°”æƒ³æœ‰æ²¡æœ‰æ›´å¥½çš„é€‰æ‹©','å®¹æ˜“è§‰å¾—å½“æ—¶é€‰é”™äº†','é™·å…¥å¦‚æœå½“åˆçš„æ­»å¾ªç¯']},
    {t:'æ”¶åˆ°åˆ«äººå¯¹ä½ çš„è´Ÿé¢è¯„ä»·ï¼Œä½ çš„ç¬¬ä¸€ååº”æ˜¯ï¼Ÿ', h:'æœ‹å‹åæ§½æˆ–ç½‘ç»œè¯„è®º',
     o:['æœ‰åˆ™æ”¹ä¹‹ï¼Œæ— ç†å°±æ— è§†','æœ‰äº›åœ¨æ„ï¼Œä½†èƒ½å¹³å¤','è®°åœ¨å¿ƒé‡Œï¼Œå½±å“å¾ˆä¹…','å¼€å§‹å¦å®šè‡ªå·±ï¼Œè§‰å¾—è‡ªå·±å¾ˆå·®']},
    {t:'ä½ æœ‰å¤šå°‘è¯æ˜¯æƒ³è¯´ä½†æ²¡è¯´å‡ºå£çš„ï¼Ÿ', h:'å¯¹å®¶äººã€æœ‹å‹ã€åŒäº‹',
     o:['å¾ˆå°‘ï¼Œæƒ³è¯´å°±è¯´','å¶å°”ï¼Œä½†ä¸ä¼šç§¯å‹','æŒºå¤šçš„ï¼Œå¾ˆå¤šè¯æ†‹åœ¨å¿ƒé‡Œ','å¤§é‡çš„è¯æ°¸è¿œç•™åœ¨è‚šå­é‡Œ']},
    {t:'å½“ä½ ç‹¬å¤„æ—¶ï¼Œå¤§è„‘é€šå¸¸åœ¨åšä»€ä¹ˆï¼Ÿ', h:'ä¸€ä¸ªäººåœ¨å®¶ï¼Œæ²¡æœ‰ç‰¹åˆ«çš„äº‹',
     o:['äº«å—å®‰é™ï¼Œåšå–œæ¬¢çš„äº‹','å¶å°”å‘å‘†ï¼ŒæŒºæ”¾æ¾çš„','å®¹æ˜“æƒ³å¤ªå¤šï¼Œåœä¸ä¸‹æ¥','è‡ªåŠ¨æ’­æ”¾å„ç§è´Ÿé¢ç”»é¢']},
    {t:'ä½ ä¸Šä¸€æ¬¡çœŸæ­£æ”¾ç©ºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ', h:'ä¸æƒ³ä»»ä½•äº‹ï¼Œå®Œå…¨è½»æ¾çš„çŠ¶æ€',
     o:['æœ€è¿‘å°±æœ‰ï¼ŒæŒºå¸¸è§çš„','ä¸Šå‘¨ï¼Œå¶å°”ä¼šæœ‰','è¦æƒ³ä¸€ä¼šå„¿â€¦â€¦ä¸Šä¸ªæœˆï¼Ÿ','æƒ³ä¸èµ·æ¥äº†ï¼Œå¥½åƒå¾ˆå°‘']},
    {t:'æƒ…ç»ªä½è½æ—¶ï¼Œä½ é€šå¸¸ä¼šâ€¦â€¦', h:'ç„¦è™‘ã€å§”å±ˆã€éš¾è¿‡çš„æ—¶å€™',
     o:['æ‰¾åˆ°åŸå› ï¼Œå¤„ç†æˆ–æ¥å—','è½¬ç§»æ³¨æ„åŠ›ï¼Œæ…¢æ…¢å°±å¥½äº†','åå¤æ„Ÿå—é‚£æƒ…ç»ªï¼Œå‡ºä¸æ¥','é™·è¿›å»å¾ˆæ·±ï¼Œå½±å“æ‰€æœ‰äº‹']},
    {t:'ä½ åœ¨æ„åˆ«äººæ€ä¹ˆçœ‹ä½ å—ï¼Ÿ', h:'é™Œç”Ÿäººã€åŒäº‹ã€æœ‹å‹çš„çœ¼å…‰',
     o:['ä¸å¤ªåœ¨æ„ï¼Œåšè‡ªå·±å°±å¥½','æœ‰æ—¶åœ¨æ„ï¼Œä½†ä¸å½±å“è¡ŒåŠ¨','æ¯”è¾ƒåœ¨æ„ï¼Œä¼šè°ƒæ•´è¡Œä¸º','éå¸¸åœ¨æ„ï¼Œå¾ˆå¤šäº‹å› æ­¤ä¸æ•¢åš']},
    {t:'é‡åˆ°å†²çªæˆ–çŸ›ç›¾ï¼Œä½ çš„ç¬¬ä¸€ååº”æ˜¯ï¼Ÿ', h:'å’Œæœ‹å‹é—¹åˆ«æ‰­ã€å·¥ä½œæ‘©æ“¦ç­‰',
     o:['ç›´æ¥æ²Ÿé€šï¼ŒæŠŠè¯è¯´æ¸…æ¥š','å…ˆå†·é™ä¸€ä¸‹ï¼Œå†æƒ³æ€ä¹ˆå¤„ç†','è§‰å¾—æ˜¯è‡ªå·±çš„é—®é¢˜ï¼Œå…ˆé“æ­‰','ä¸æ–­å›æƒ³ï¼Œè§‰å¾—è‡ªå·±å“ªé‡Œä¸å¯¹']},
    {t:'ä½ ç»™è‡ªå·±å……ç”µçš„æ–¹å¼æ˜¯ä»€ä¹ˆï¼Ÿ', h:'ç”¨æ¥æ¢å¤èƒ½é‡çš„æ–¹å¼',
     o:['ç¡ä¸€è§‰å°±å¥½äº†ï¼Œæ¢å¤å¾ˆå¿«','éœ€è¦ä¸€äº›æ—¶é—´ï¼Œä½†èƒ½æ¢å¤','è¦å¾ˆä¹…æ‰èƒ½ç¼“è¿‡æ¥','æ„Ÿè§‰å¾ˆéš¾çœŸæ­£å……æ»¡ç”µ']},
    {t:'ä½ ä¼šä¸ºè¿˜æ²¡å‘ç”Ÿçš„äº‹æå‰æ‹…å¿ƒå—ï¼Ÿ', h:'æ¯”å¦‚æ˜å¤©çš„ä¼šè®®ã€ä¸‹å‘¨çš„èšä¼š',
     o:['å¾ˆå°‘ï¼Œåˆ°æ—¶å€™å†è¯´','å¶å°”ï¼Œä½†ä¸ä¼šå¤ªç„¦è™‘','ç»å¸¸ï¼Œä¼šåœ¨è„‘å­é‡Œé¢„æ¼”å¾ˆå¤šé','å‡ ä¹ä¸€ç›´åœ¨ä¸ºæœªæ¥çš„äº‹ç„¦è™‘']},
    {t:'ä½ æœ‰æ²¡æœ‰è§‰å¾—è‡ªå·±ä¸€ç›´å¾ˆç´¯ï¼Œä½†è¯´ä¸æ¸…æ¥šç´¯åœ¨å“ªï¼Ÿ', h:'é‚£ç§è¯´ä¸å‡ºåŸå› çš„ç–²æƒ«æ„Ÿ',
     o:['å¾ˆå°‘æœ‰è¿™ç§æ„Ÿè§‰','å¶å°”ï¼Œä¼‘æ¯åèƒ½å¥½','ç»å¸¸æœ‰ï¼Œä½†å‹‰å¼ºæ’‘ç€','å‡ ä¹æ¯å¤©éƒ½è¿™æ ·ï¼Œä¹ æƒ¯äº†']}
  ];

  var R = [
    {lv:'lv1',min:0,max:12,badge:'å†…è€—ç»¿æ´²',emoji:'ğŸŒ¿',
     title:'ä½ çš„èƒ½é‡å‡ ä¹æ²¡æœ‰æ³„æ¼',
     tag:'æƒ…ç»ªè‡ªæ„ˆåŠ›æå¼ºï¼Œå†…å¿ƒæœ‰ä¸€ç‰‡çœŸæ­£çš„å®‰é™ä¹‹åœ°',
     desc:'ä½ å¯¹æƒ…ç»ªæœ‰å¾ˆå¼ºçš„æ¶ˆåŒ–èƒ½åŠ›ï¼Œä¸å®¹æ˜“è¢«å¤–ç•Œè¯„ä»·æˆ–çªå‘äº‹ä»¶é•¿ä¹…å½±å“ã€‚ä½ èƒ½å¿«é€Ÿä»è´Ÿé¢çŠ¶æ€æŠ½ç¦»ï¼ŒæŠŠèƒ½é‡ç”¨åœ¨çœŸæ­£å€¼å¾—çš„åœ°æ–¹ã€‚è¿™ç§å†…å¿ƒçš„ç¨³å®šæ„Ÿæ˜¯å¾ˆå¤šäººåŠªåŠ›è¿½æ±‚å´éš¾ä»¥æŠµè¾¾çš„çŠ¶æ€ã€‚',
     traits:['æƒ…ç»ªç¨³å®š','è‡ªæˆ‘è¾¹ç•Œæ¸…æ™°','æ´»åœ¨å½“ä¸‹','ä¸è½»æ˜“å†…è€—','æ¢å¤åŠ›å¼º'],
     advTitle:'ç»§ç»­ä¿æŒçš„æ–¹å‘',
     adv:[{i:'ğŸŒ±',t:'å®šæœŸè§‰å¯Ÿæƒ…ç»ªæ¥æºï¼Œä¿æŒè¿™ä»½å¹³è¡¡æ„Ÿ'},{i:'ğŸ’¬',t:'ä½ æ˜¯å¤©ç„¶çš„æƒ…ç»ªé”šç‚¹ï¼Œå¯ä»¥æ¸©æŸ”å½±å“èº«è¾¹çš„äºº'},{i:'ğŸ”',t:'æ³¨æ„ä¸è¦å› ä¸ºè‡ªå·±æƒ…ç»ªå¥½ï¼Œè€Œå¿½è§†ä»–äººçš„æƒ…ç»ªéœ€æ±‚'},{i:'âœ¨',t:'ç»§ç»­æ»‹å…»è®©ä½ æ„Ÿåˆ°å¹³é™çš„äº‹ç‰©å’Œå…³ç³»'}]},
    {lv:'lv2',min:13,max:24,badge:'è½»åº¦å†…è€—',emoji:'ğŸŒ¸',
     title:'å¶å°”æ¼ç”µï¼Œä½†è¿˜åœ¨æŒæ§ä¸­',
     tag:'ä½ æœ‰å†…è€—ï¼Œä½†ä½ æ„è¯†å¾—åˆ°â€”â€”è¿™å·²ç»å¾ˆäº†ä¸èµ·äº†',
     desc:'ä½ ä¼šåœ¨æŸäº›äº‹æƒ…ä¸Šæ¶ˆè€—é¢å¤–çš„ç²¾åŠ›ï¼Œä½†æ•´ä½“è¿˜åœ¨å¯æ§èŒƒå›´å†…ã€‚ä½ æœ‰ä¸€å®šçš„è‡ªæˆ‘è§‰å¯Ÿèƒ½åŠ›ï¼Œèƒ½æ„ŸçŸ¥åˆ°å†…è€—æ­£åœ¨å‘ç”Ÿï¼Œåªæ˜¯æœ‰æ—¶å€™åœä¸ä¸‹æ¥ã€‚è¿™ä¸ªé˜¶æ®µçš„å…³é”®ï¼Œæ˜¯å­¦ä¼šæå‰æˆªæ–­â€”â€”åœ¨æƒ…ç»ªå¼€å§‹èºæ—‹ä¹‹å‰ï¼Œæ¸©æŸ”åœ°æŒ‰ä¸‹æš‚åœé”®ã€‚',
     traits:['æœ‰è‡ªæˆ‘è§‰å¯Ÿ','å¶å°”è¿‡åº¦æ€è€ƒ','åœ¨æ„ä»–äººæ„Ÿå—','æœ‰æ—¶éš¾ä»¥æ”¾ä¸‹','æ•æ„Ÿç»†è…»'],
     advTitle:'è®©èƒ½é‡å°‘æ¼ä¸€äº›',
     adv:[{i:'â¸ï¸',t:'å‘ç°è‡ªå·±å¼€å§‹åå¤æƒ³æ—¶ï¼Œç«‹åˆ»åšä¸€ä»¶éœ€è¦ä¸“æ³¨çš„äº‹æ¥æ‰“æ–­'},{i:'ğŸ“',t:'ç»ƒä¹ äº‹åä¸å¤ç›˜â€”â€”åšå®Œå†³å®šå°±æ”¾ä¸‹ï¼Œä¸è¦åå¤è´¨ç–‘'},{i:'ğŸ•',t:'è®¾å®šæ‹…å¿§æ—¶é—´ï¼Œæ¯å¤©åªå…è®¸è‡ªå·±ç„¦è™‘15åˆ†é’Ÿ'},{i:'ğŸŒ™',t:'ç¡å‰åš3æ¬¡æ·±å‘¼å¸ï¼Œå‘Šè¯‰è‡ªå·±ä»Šå¤©å·²ç»ç»“æŸäº†'}]},
    {lv:'lv3',min:25,max:35,badge:'ä¸­åº¦å†…è€—',emoji:'ğŸ‚',
     title:'ä½ æ¯å¤©æ‚„æ‚„æ¼æ‰å¤§é‡èƒ½é‡',
     tag:'é‚£äº›æ²¡è¯´å‡ºå£çš„è¯ï¼Œæ­£åœ¨ä¸€ç‚¹ç‚¹æ¶ˆè€—ç€ä½ ',
     desc:'ä½ çš„èƒ½é‡æœ‰ç›¸å½“ä¸€éƒ¨åˆ†æ¶ˆè€—åœ¨åå¤å›æƒ³ã€è¿‡åº¦æ£æ‘©å’Œæ— æ³•ç¿»ç¯‡ä¸Šã€‚ä½ å¸¸å¸¸è§‰å¾—ç´¯ï¼Œå´è¯´ä¸æ¸…æ¥šåœ¨ç´¯ä»€ä¹ˆã€‚å…¶å®ä½ æ˜¯åœ¨æ¶ˆè€—ç²¾åŠ›ç»´æŒä¸€ä¸ªè¡¨é¢è¿˜å¥½çš„çŠ¶æ€ï¼ŒåŒæ—¶å†…å¿ƒåœ¨ä¸åœåœ°è¿è½¬ã€‚é•¿æœŸå¦‚æ­¤ï¼Œä¼šæ‚„æ‚„å½±å“ç¡çœ å’Œåšäº‹çš„çƒ­æƒ…ã€‚',
     traits:['æ•æ„Ÿç»†è…»','éš¾ä»¥æ”¾ä¸‹','è¿‡åº¦æ€è€ƒ','è¡¨è¾¾éœ€æ±‚å°‘','æƒ…ç»ªç§¯å‹'],
     advTitle:'ä½ ç°åœ¨æœ€éœ€è¦çš„',
     adv:[{i:'ğŸ““',t:'æŠŠè„‘å­é‡Œçš„æƒ³æ³•å†™ä¸‹æ¥â€”â€”å¤–åŒ–æ¯”å†…åŒ–æ¶ˆè€—æ›´å°‘çš„èƒ½é‡'},{i:'ğŸ—£ï¸',t:'ç»ƒä¹ è¯´å‡ºæˆ‘ä¸èˆ’æœï¼Œå‡å°‘æ†‹åœ¨å¿ƒé‡Œçš„è¯'},{i:'ğŸš¶',t:'æ¯å¤©ç»™è‡ªå·±30åˆ†é’Ÿä¸æ€è€ƒæ—¶é—´ï¼Œæ•£æ­¥ã€å‘å‘†éƒ½è¡Œ'},{i:'ğŸ’­',t:'å‡å°‘å¯¹ä»–äººååº”çš„è¿‡åº¦è§£è¯»ï¼Œ90%çš„æ£æ‘©éƒ½æ˜¯è‡ªå·±å“è‡ªå·±'}]},
    {lv:'lv4',min:36,max:45,badge:'é‡åº¦å†…è€—',emoji:'ğŸŒ§ï¸',
     title:'ä½ çš„èƒ½é‡æ­£åœ¨å¤§é‡æµå¤±',
     tag:'ä½ ä¸æ˜¯ä¸å¤ŸåŠªåŠ›ï¼Œæ˜¯æŠŠåŠ›æ°”ç”¨åœ¨äº†çœ‹ä¸è§çš„åœ°æ–¹',
     desc:'ä½ æœ‰ç›¸å½“ç¨‹åº¦çš„æƒ…ç»ªå†…è€—æ¨¡å¼ã€‚å¤§é‡ç²¾åŠ›è¢«ç”¨äºåå¤æ€è€ƒã€è‡ªæˆ‘æ€€ç–‘ã€æ£æ‘©ä»–äººã€å‹æŠ‘è¡¨è¾¾ã€‚ä½ çš„ç–²æƒ«ä¸æ˜¯å·æ‡’ï¼Œè€Œæ˜¯ä¸€ç›´åœ¨åšéšå½¢çš„æƒ…ç»ªåŠ³åŠ¨ã€‚è¿™ç§æ¨¡å¼é€šå¸¸ä»å¾ˆæ—©å°±å¼€å§‹äº†ï¼Œå·²ç»å†…åŒ–ä¸ºè‡ªåŠ¨è¿è½¬çš„ä¹ æƒ¯ï¼Œä½†å®ƒæ˜¯å¯ä»¥æ…¢æ…¢æ”¹å˜çš„ã€‚è¯·æ¸©æŸ”åœ°å¯¹å¾…è‡ªå·±ã€‚',
     traits:['é«˜åº¦æ•æ„Ÿ','è‡ªæˆ‘æ€€ç–‘','æƒ…ç»ªç§¯å‹','éš¾ä»¥æ”¾ç©º','éšæ€§ç–²æƒ«æ„Ÿå¼º'],
     advTitle:'æœ€æƒ³å¯¹ä½ è¯´çš„è¯',
     adv:[{i:'ğŸ¤',t:'åœæ­¢å¯¹è‡ªå·±è¯´è¿™æœ‰ä»€ä¹ˆå¥½éš¾è¿‡çš„â€”â€”æ¥çº³æƒ…ç»ªæ‰æ˜¯æ”¹å˜çš„èµ·ç‚¹'},{i:'ğŸ“–',t:'æ‰¾ä¸€ä¸ªå¯ä»¥è¯´çœŸå¿ƒè¯çš„å‡ºå£ï¼Œå“ªæ€•åªæ˜¯å†™æ—¥è®°'},{i:'ğŸŒ¿',t:'è®¤çœŸè€ƒè™‘å’Œå¿ƒç†å’¨è¯¢å¸ˆèŠèŠï¼Œä½ å€¼å¾—è¢«ä¸“ä¸šæ”¯æŒ'},{i:'â˜•',t:'æ¯å¤©åšä¸€ä»¶çº¯ç²¹è®©è‡ªå·±å¼€å¿ƒçš„å°äº‹ï¼Œå“ªæ€•åªæœ‰5åˆ†é’Ÿ'}]}
  ];

  var curQ=0, score=0, chosen=null, result=null;

  function $(id){ return document.getElementById(id); }

  // ===== æ¿€æ´»ç é€»è¾‘ =====
  function initActivate() {
    $('eye-btn').addEventListener('click', function(){
      var inp = $('code-input');
      if(inp.type==='password'){ inp.type='text'; $('eye-btn').textContent='ğŸ™ˆ'; }
      else { inp.type='password'; $('eye-btn').textContent='ğŸ‘'; }
    });

    $('code-input').addEventListener('input', function(){
      $('act-error').textContent='';
    });

    $('code-input').addEventListener('keydown', function(e){
      if(e.key==='Enter') doActivate();
    });

    $('btn-activate').addEventListener('click', doActivate);
  }

  function doActivate() {
    var raw = $('code-input').value;
    var err = validateCode(raw);
    if(err){
      var el = $('act-error');
      el.textContent = err;
      $('code-input').style.borderColor='#D4756A';
      setTimeout(function(){ $('code-input').style.borderColor=''; },2000);
      return;
    }
    // éªŒè¯é€šè¿‡
    var code = raw.trim().toUpperCase();
    markUsed(code);
    $('pg-activate').style.display='none';
    $('pg-cover').style.display='flex';
  }

  // ===== æµ‹è¯•é€»è¾‘ =====
  function startQuiz() {
    $('pg-cover').style.display='none';
    $('pg-quiz').style.display='block';
    renderQ();
  }

  function renderQ() {
    var q = Q[curQ];
    var wrap = $('q-wrap');
    wrap.classList.remove('slide-in'); void wrap.offsetWidth; wrap.classList.add('slide-in');
    $('q-frac').textContent=(curQ+1)+' / '+Q.length;
    $('prog-fill').style.width=(curQ/Q.length*100)+'%';
    $('q-num-text').textContent='é¢˜ç›® '+('0'+(curQ+1)).slice(-2);
    $('q-text').textContent=q.t;
    $('q-hint').textContent=q.h;
    var ow=$('opts-wrap'); ow.innerHTML='';
    q.o.forEach(function(txt,i){
      var btn=document.createElement('button');
      btn.className='opt';
      btn.innerHTML='<div class="oc">âœ“</div><div class="ot">'+txt+'</div>';
      btn.style.opacity='0'; btn.style.transform='translateY(10px)';
      btn.style.transition='opacity .3s ease,transform .3s ease,border-color .25s ease,background .25s ease';
      btn.addEventListener('click',function(){ pickOpt(btn,i); });
      ow.appendChild(btn);
      setTimeout(function(){ btn.style.opacity='1'; btn.style.transform='translateY(0)'; },80+i*60);
    });
    chosen=null;
    var nb=$('btn-next'); nb.classList.remove('show');
    nb.textContent=curQ===Q.length-1?'æŸ¥çœ‹ç»“æœ ğŸŒ¸':'ç»§ç»­ â†’';
  }

  function pickOpt(btn,idx){
    document.querySelectorAll('.opt').forEach(function(b){ b.classList.remove('chosen'); });
    btn.classList.add('chosen'); chosen=idx;
    $('btn-next').classList.add('show');
  }

  function goNext(){
    if(chosen===null) return;
    score+=chosen;
    if(curQ<Q.length-1){ curQ++; renderQ(); } else showResult();
  }

  function showResult(){
    $('pg-quiz').style.display='none';
    $('pg-result').style.display='block';
    window.scrollTo(0,0);
    var maxRaw=Q.length*3;
    var norm=Math.round(score/maxRaw*100);
    result=R[R.length-1];
    for(var i=0;i<R.length;i++){ if(score>=R[i].min&&score<=R[i].max){ result=R[i]; break; } }
    $('res-card').className='rc fade-in '+result.lv;
    $('advice-card').className='ac fade-in '+result.lv;
    var c=0;
    var timer=setInterval(function(){ c+=2; if(c>=norm){c=norm;clearInterval(timer);} $('res-score').textContent=c; },18);
    $('res-raw').textContent='åŸå§‹å¾—åˆ† '+score+' / '+maxRaw;
    $('res-badge').textContent=result.badge;
    $('res-emoji').textContent=result.emoji;
    $('res-title').textContent=result.title;
    $('res-tagline').textContent=result.tag;
    $('res-desc').textContent=result.desc;
    $('res-traits').innerHTML=result.traits.map(function(t){ return '<span class="rtrait">'+t+'</span>'; }).join('');
    $('advice-title').textContent=result.advTitle;
    $('advice-items').innerHTML=result.adv.map(function(a){ return '<div class="ai"><div class="aico">'+a.i+'</div><div class="ait">'+a.t+'</div></div>'; }).join('');
  }

  function copyResult(){
    var s=$('res-score').textContent;
    var text='ğŸŒ¸ æˆ‘åšäº†æƒ…ç»ªå†…è€—æµ‹è¯•\n\nå¾—åˆ†ï¼š'+s+'åˆ†\nç­‰çº§ï¼š'+result.badge+'\nç»“æœï¼š'+result.title+'\n\nã€Œ'+result.tag+'ã€\n\nä½ ä¹Ÿæ¥æµ‹æµ‹è‡ªå·±æ¯å¤©æ¼æ‰å¤šå°‘èƒ½é‡ï¼Ÿ\nğŸ‘‡ï¼ˆæµ‹è¯•é“¾æ¥æ”¾è¯„è®ºåŒºï¼‰';
    var btn=$('btn-share');
    function done(){ btn.textContent='âœ… å·²å¤åˆ¶ï¼å»å°çº¢ä¹¦å‘å¸–å§'; setTimeout(function(){ btn.textContent='ğŸ“‹ ä¸€é”®å¤åˆ¶å°çº¢ä¹¦æ–‡æ¡ˆ'; },3000); }
    if(navigator.clipboard&&navigator.clipboard.writeText){ navigator.clipboard.writeText(text).then(done); }
    else{ var ta=document.createElement('textarea'); ta.value=text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta); done(); }
  }

  function restart(){
    curQ=0; score=0; chosen=null; result=null;
    $('pg-result').style.display='none';
    $('pg-cover').style.display='flex';
    window.scrollTo(0,0);
  }

  window.addEventListener('DOMContentLoaded', function(){
    initActivate();
    $('btn-start').addEventListener('click', startQuiz);
    $('btn-next').addEventListener('click', goNext);
    $('btn-share').addEventListener('click', copyResult);
    $('btn-retry').addEventListener('click', restart);
  });

})();
</script>
</body>
</html>
